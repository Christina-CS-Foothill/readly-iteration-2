<!DOCTYPE html>
<html lang="en">

  <head>
    <title>ðŸ“š Readly.</title>
    <link rel="stylesheet" href="/styles/index.css">
    <link rel="stylesheet" href="/styles/new-story.css">
    <link rel="stylesheet" href="/styles/edit-story.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&family=Roboto:wght@400;900&display=swap"
      rel="stylesheet">
    <script>
      let goBack = function () {
        if (confirm("Are you sure? All your changes will be discarded.")) {
          history.back();
        }
      }
    </script>
  </head>

  <body>

    <%- include("includes/header.ejs") %>

      <h1>Edit Story</h1>
      <section class="create-new-story">
        <form action="/edit-story/<%= story.id %>" method="post">
          <ul>
            <li>
              <label for="story-title">Story Title</label>
              <input type="text" name="storytitle" id="story-title" required value="<%= story.storytitle %>" />
            </li>

            <li class="non-editable">
              <label>Author:</label>
              <input value="<%= story.authorname %>(<%= story.authorid %>)" readonly />
            </li>

            <section class="genre-options">
              <p>Genre (Choose at least 1)</p>
              <ul>
                <li class="form-control-inline">
                  <% let isChecked=story.genre.includes("fantasy"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="fantasy" name="genre" value="fantasy" checked />
                      <% } else { %>
                        <input type="checkbox" id="fantasy" name="genre" value="fantasy" />
                        <% } %>
                          <label for="fantasy">Fantasy</label>
                </li>

                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("romance"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="romance" name="genre" value="romance" checked />
                      <% } else { %>
                        <input type="checkbox" id="romance" name="genre" value="romance" />
                        <% } %>
                          <label for="romance">Romance</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("action"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="action" name="genre" value="action" checked />
                      <% } else { %>
                        <input type="checkbox" id="action" name="genre" value="action" />
                        <% } %>
                          <label for="action">Action</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("adventure"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="adventure" name="genre" value="adventure" checked />
                      <% } else { %>
                        <input type="checkbox" id="adventure" name="genre" value="adventure" />
                        <% } %>
                          <label for="adventure">Adventure</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("drama"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="drama" name="genre" value="drama" checked />
                      <% } else { %>
                        <input type="checkbox" id="drama" name="genre" value="drama" />
                        <% } %>
                          <label for="drama">Drama</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("horror"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="horror" name="genre" value="horror" checked />
                      <% } else { %>
                        <input type="checkbox" id="horror" name="genre" value="horror" />
                        <% } %>
                          <label for="horror">Horror</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("comedy"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="comedy" name="genre" value="comedy" checked />
                      <% } else { %>
                        <input type="checkbox" id="comedy" name="genre" value="comedy" />
                        <% } %>
                          <label for="comedy">Comedy</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("angst"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="angst" name="genre" value="angst" checked />
                      <% } else { %>
                        <input type="checkbox" id="angst" name="genre" value="angst" />
                        <% } %>
                          <label for="angst">Angst</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("fanfiction"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="fanfiction" name="genre" value="fanfiction" checked />
                      <% } else { %>
                        <input type="checkbox" id="fanfiction" name="genre" value="fanfiction" />
                        <% } %>
                          <label for="fanfiction">Fanfiction</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("original"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="original" name="genre" value="original" checked />
                      <% } else { %>
                        <input type="checkbox" id="original" name="genre" value="original" />
                        <% } %>
                          <label>Original</label>
                </li>
                <li class="form-control-inline">
                  <% isChecked=story.genre.includes("other"); %>
                    <% if(isChecked) { %>
                      <input type="checkbox" id="other" name="genre" value="other" checked />
                      <% } else { %>
                        <input type="checkbox" id="other" name="genre" value="other" />
                        <% } %>
                          <label for="other">Other</label>
                </li>
              </ul>
            </section>

            <li>
              <label for="imageurl">Story Image</label>
              <select id="imageurl" name="imageurl">
                <% if( story.imageurl==="/images/fantasy-cover.jpg" ) { %>
                  <option value="/images/fantasy-cover.jpg" selected="true">Fantasy Cover</option>
                  <% } else { %>
                    <option value="/images/fantasy-cover.jpg">Fantasy Cover</option>
                    <% } %>

                      <% if( story.imageurl==="/images/romance-cover.png" ) { %>
                        <option value="/images/romance-cover.png" selected="true">Romance Cover</option>
                        <% } else { %>
                          <option value="/images/romance-cover.png">Romance Cover</option>
                          <% } %>

                            <% if( story.imageurl==="/images/action-cover.png" ) { %>
                              <option value="/images/action-cover.png" selected="true">Action Cover</option>
                              <% } else { %>
                                <option value="/images/action-cover.png">Action Cover</option>
                                <% } %>

                                  <% if( story.imageurl==="/images/adventure-cover.png" ) { %>
                                    <option value="/images/adventure-cover.png" selected="true">Adventure Cover</option>
                                    <% } else { %>
                                      <option value="/images/adventure-cover.png">Adventure Cover</option>
                                      <% } %>

                                        <% if( story.imageurl==="/images/drama-cover.png" ) { %>
                                          <option value="/images/drama-cover.png" selected="true">Drama Cover</option>
                                          <% } else { %>
                                            <option value="/images/drama-cover.png">Drama Cover</option>
                                            <% } %>

                                              <% if( story.imageurl==="/images/horror-cover.png" ) { %>
                                                <option value="/images/horror-cover.png" selected="true">Horror Cover
                                                </option>
                                                <% } else { %>
                                                  <option value="/images/horror-cover.png">Horror Cover</option>
                                                  <% } %>

                                                    <% if( story.imageurl==="/images/comedy-cover.png" ) { %>
                                                      <option value="/images/comedy-cover.png" selected="true">Comedy
                                                        Cover</option>
                                                      <% } else { %>
                                                        <option value="/images/comedy-cover.png">Comedy Cover</option>
                                                        <% } %>

                                                          <% if( story.imageurl==="/images/angst-cover.png" ) { %>
                                                            <option value="/images/angst-cover.png" selected="true">
                                                              Angst Cover</option>
                                                            <% } else { %>
                                                              <option value="/images/angst-cover.png">Angst Cover
                                                              </option>
                                                              <% } %>

                                                                <% if( story.imageurl==="/images/fanfiction-cover.png" )
                                                                  { %>
                                                                  <option value="/images/fanfiction-cover.png"
                                                                    selected="true">Fanfiction Cover</option>
                                                                  <% } else { %>
                                                                    <option value="/images/fanfiction-cover.png">
                                                                      Fanfiction Cover</option>
                                                                    <% } %>

                                                                      <% if(
                                                                        story.imageurl==="/images/original-cover.png" )
                                                                        { %>
                                                                        <option value="/images/original-cover.png"
                                                                          selected="true">Original Cover</option>
                                                                        <% } else { %>
                                                                          <option value="/images/original-cover.png">
                                                                            Original Cover</option>
                                                                          <% } %>

                                                                            <% if(
                                                                              story.imageurl==="/images/other-cover.png"
                                                                              ) { %>
                                                                              <option value="/images/other-cover.png"
                                                                                selected="true">Other Cover</option>
                                                                              <% } else { %>
                                                                                <option value="/images/other-cover.png">
                                                                                  Other Cover</option>
                                                                                <% } %>


              </select>
            </li>

            <li id="image-previews">
              <label>Image Previews</label>
              <div>
                <article>
                  <img src="/images/fantasy-cover.jpg">
                  <p>Fantasy</p>
                </article>
                <article>
                  <img src="/images/romance-cover.png">
                  <p>Romance</p>
                </article>
                <article>
                  <img src="/images/action-cover.png">
                  <p>Action</p>
                </article>
                <article>
                  <img src="/images/adventure-cover.png">
                  <p>Adventure</p>
                </article>
                <article>
                  <img src="/images/drama-cover.png">
                  <p>Drama</p>
                </article>
                <article>
                  <img src="/images/horror-cover.png">
                  <p>Horror</p>
                </article>
                <article>
                  <img src="/images/comedy-cover.png">
                  <p>Comedy</p>
                </article>
                <article>
                  <img src="/images/angst-cover.png">
                  <p>Angst</p>
                </article>
                <article>
                  <img src="/images/fanfiction-cover.png">
                  <p>Fanfiction</p>
                </article>
                <article>
                  <img src="/images/original-cover.png">
                  <p>Original</p>
                </article>
                <article>
                  <img src="/images/other-cover.png">
                  <p>Other</p>
                </article>
              </div>
            </li>

            <li>
              <label for="story-summary">Story Summary/Description</label>
              <textarea rows="5" type="text" name="storysummary" id="story-summary"
                required><%= story.storysummary %></textarea>
            </li>
          </ul>

          <section class="buttons">
            <button type="submit">Save/Update</button>
            <button type="button" onclick="goBack()">Cancel</button>
          </section>
        </form>
      </section>

      <section class="chapters-to-edit">
        <h1>Edit a chapter?</h1>
        <ol>
          <% for(chapter of chapters) { %>
            <li>
              <a href="/edit-chapter/<%= chapter.id %>">
                <%= chapter.chapterTitle%>
              </a>
            </li>
            <% } %>
        </ol>
      </section>
      <%- include("includes/footer.ejs") %>
  </body>

</html>